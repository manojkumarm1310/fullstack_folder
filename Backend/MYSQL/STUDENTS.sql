CREATE DATABASE COLLEGE;
SHOW DATABASES;
USE COLLEGE;
CREATE TABLE STUDENT(
		ID INT NOT NULL AUTO_INCREMENT,
        STNAME VARCHAR(50) NOT NULL,
        AGE INT NOT NULL,
        GENDER VARCHAR(7) NOT NULL,
        CID INT NOT NULL,
        ROLLNO VARCHAR(3) NOT NULL,
        PRIMARY KEY(ID)
        );
CREATE TABLE COURSE(
		CID INT NOT NULL,
        CNAME VARCHAR(5) NOT NULL
        );
CREATE TABLE MARK(
		ID INT NOT NULL AUTO_INCREMENT,
        M1 INT NOT NULL,
        M2 INT NOT NULL,
        M3 INT NOT NULL,
        PRIMARY KEY(ID)
        );
ALTER TABLE STUDENT ADD SKILL VARCHAR(2) NOT NULL;
INSERT INTO STUDENT(ID,STNAME,AGE,SKILL,CID,ROLLNO,GENDER) 
			VALUES (NULL,'PARTHI',29,'A',1,'A1','M'),
				  (NULL,'RANJITH',27,'A',1,'A2','M'),
                  (NULL,'PRABHA',27,'B',2,'A3','M'),
                  (NULL,'NAGA',27,'B',2,'A4','M'),
                  (NULL,'KARTHI',27,'A',1,'A5','M'),
                  (NULL,'VENGAT',27,'A',1,'A6','M'),
                  (NULL,'MANO',26,'C',3,'A7','M'),
                  (NULL,'NAGEN',26,'B',2,'A8','M'),
                  (NULL,'BALAFZ',25,'A',1,'A9','M'),
                  (NULL,'SURYA',26,'C',3,'A10','M'),
                  (NULL,'JAGAN',26,'C',3,'A11','M'),
                  (NULL,'BARATH',24,'C',3,'A12','M'),
                  (NULL,'BALA',24,'A',1,'A13','M'),
                  (NULL,'MANOJ',23,'C',3,'A14','M'),
                  (NULL,'NAVEEN',23,'C',3,'A15','M'),
                  (NULL,'BARATHMT',22,'C',3,'A16','M');
ALTER TABLE COURSE MODIFY CNAME VARCHAR(15) NOT NULL;
INSERT INTO COURSE (CID,CNAME) 
			VALUES 	(1,'BATSMAN'),
					(2,'BOWLER'),
                    (3,'ALLROUNDER');
INSERT INTO MARK (ID,M1,M2,M3) 
			VALUES (NULL,50,32,49),
					(NULL,43,27,35),
                    (NULL,34,37,34),
                    (NULL,24,46,33),
                    (NULL,51,36,31),
                    (NULL,45,45,33),
                    (NULL,42,31,32),
                    (NULL,34,26,18),
                    (NULL,42,15,23),
                    (NULL,44,23,21),
                    (NULL,31,23,44),
                    (NULL,34,45,23),
                    (NULL,44,26,43),
                    (NULL,40,31,34),
                    (NULL,20,12,35),
                    (NULL,10,26,33),
                    (NULL,30,48,43);
DELETE FROM MARK WHERE ID=17;
SELECT * FROM STUDENT;
SELECT * FROM COURSE;
SELECT * FROM MARK;
SHOW TABLES;

SELECT STUDENT.STNAME,STUDENT.ROLLNO,STUDENT.CID,COURSE.CNAME FROM STUDENT INNER JOIN COURSE ON STUDENT.CID=COURSE.CID;

SELECT STUDENT.ID,STUDENT.STNAME,STUDENT.ROLLNO,STUDENT.CID,COURSE.CNAME,MARK.M1,MARK.M2,MARK.M3 FROM STUDENT 
				INNER JOIN COURSE ON STUDENT.CID=COURSE.CID
                INNER JOIN MARK ON STUDENT.ID=MARK.ID;


SELECT STUDENT.ID,STUDENT.STNAME,STUDENT.ROLLNO,STUDENT.CID,COURSE.CNAME,MARK.M1,MARK.M2,MARK.M3,(MARK.M1+MARK.M2+MARK.M3) AS TOTAL FROM STUDENT 
				INNER JOIN COURSE ON STUDENT.CID=COURSE.CID
                INNER JOIN MARK ON STUDENT.ID=MARK.ID;

SELECT STUDENT.ID,STUDENT.STNAME,STUDENT.ROLLNO,STUDENT.CID,COURSE.CNAME,MARK.M1,MARK.M2,MARK.M3,(MARK.M1+MARK.M2+MARK.M3) AS TOTAL,ROUND(((MARK.M1+MARK.M2+MARK.M3)/3),0) AS AVGER,
(
CASE 
WHEN ROUND(((MARK.M1+MARK.M2+MARK.M3)/3),0)>=40 AND ROUND(((MARK.M1+MARK.M2+MARK.M3)/3),0)<=50 THEN 'A'
WHEN ROUND(((MARK.M1+MARK.M2+MARK.M3)/3),0)>=30 AND ROUND(((MARK.M1+MARK.M2+MARK.M3)/3),0)<40 THEN 'B'
WHEN ROUND(((MARK.M1+MARK.M2+MARK.M3)/3),0)>=25 AND ROUND(((MARK.M1+MARK.M2+MARK.M3)/3),0)<30 THEN 'C'
ELSE 'U'
END
) AS GRADE FROM STUDENT 
				INNER JOIN COURSE ON STUDENT.CID=COURSE.CID
                INNER JOIN MARK ON STUDENT.ID=MARK.ID WHERE COURSE.CNAME='ALLROUNDER';
DROP DATABASE COLLEGE;